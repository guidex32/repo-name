<script>
// Логотипы
const logos = [
  'https://emojigraph.org/media/apple/grinning-face_1f600.png',
  'https://emojigraph.org/media/apple/face-with-tears-of-joy_1f602.png',
  'https://emojigraph.org/media/apple/smiling-face-with-heart-eyes_1f60d.png'
];
const logoEl = document.getElementById('logo');
function randomLogo() {
  logoEl.classList.add('fade');
  setTimeout(() => {
    logoEl.src = logos[Math.floor(Math.random() * logos.length)];
    logoEl.classList.remove('fade');
  }, 400);
}
randomLogo();
setInterval(randomLogo, 3000);

// Меню
const menu = document.getElementById('mainMenu');
const pageConfig = {
  menuItems: [
    { title: 'Главная', link: 'index.html' },
    { title: 'Музыка', link: '#' },
    { title: 'Любимое', link: 'favorites.html' }
  ]
};
pageConfig.menuItems.forEach((item) => {
  const li = document.createElement('li');
  const a = document.createElement('a');
  a.textContent = item.title;
  a.href = item.link;
  if (item.title === 'Музыка') a.classList.add('active');
  li.appendChild(a);
  menu.appendChild(li);
});
window.addEventListener('load', () => {
  document.body.classList.add('loaded');
});

// Переключение платформ и остановка других плееров
const buttons = document.querySelectorAll('.platform-btn');
const yandexPlayer = document.getElementById('yandex-player');
const spotifyPlayer = document.getElementById('spotify-player');

// iframe'ы
const spotifyIframe = spotifyPlayer.querySelector('iframe');
const yandexIframe = yandexPlayer.querySelector('iframe');

// Сохраняем оригинальные src
const yandexOriginalSrc = yandexIframe.src;

buttons.forEach(btn => {
  btn.addEventListener('click', () => {
    buttons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    const platform = btn.getAttribute('data-platform');

    if (platform === 'yandex') {
      // Остановим Spotify
      spotifyIframe.contentWindow.postMessage({
        event: 'command',
        func: 'pause'
      }, '*');

      // Перезагрузим Yandex iframe (если был выключен)
      yandexIframe.src = yandexOriginalSrc;

      yandexPlayer.classList.add('active');
      spotifyPlayer.classList.remove('active');
    } else if (platform === 'spotify') {
      // Перезагрузим Yandex, чтобы остановить воспроизведение
      yandexIframe.src = 'about:blank';

      // Включим Spotify
      spotifyIframe.contentWindow.postMessage({
        event: 'command',
        func: 'play'
      }, '*');

      spotifyPlayer.classList.add('active');
      yandexPlayer.classList.remove('active');
    }
  });
});
</script>
